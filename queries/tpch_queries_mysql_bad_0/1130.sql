SELECT PARTSUPP.PS_PARTKEY, SUPPLIER.S_NATIONKEY, NATION.N_NATIONKEY, MAX(NATION.N_NATIONKEY) FROM NATION JOIN SUPPLIER ON SUPPLIER.S_NATIONKEY=NATION.N_NATIONKEY JOIN PARTSUPP ON PARTSUPP.PS_SUPPKEY=SUPPLIER.S_SUPPKEY GROUP BY PARTSUPP.PS_PARTKEY, SUPPLIER.S_NATIONKEY, NATION.N_NATIONKEY HAVING MAX(NATION.N_NATIONKEY) < CUSTOMER ORDER BY NATION.N_NATIONKEY DESC, PARTSUPP.PS_PARTKEY ASC, SUPPLIER.S_NATIONKEY ASC;
