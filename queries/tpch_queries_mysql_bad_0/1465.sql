SELECT PART.P_PARTKEY, PARTSUPP.PS_AVAILQTY, MIN(PARTSUPP.PS_PARTKEY), COUNT(PART.P_PARTKEY) FROM PART JOIN PARTSUPP ON PARTSUPP.PS_PARTKEY=PART.P_PARTKEY GROUP BY PART.P_PARTKEY, PARTSUPP.PS_AVAILQTY ORDER BY MIN(PARTSUPP.PS_PARTKEY) ASC, COUNT(PART.P_PARTKEY) DESC;
