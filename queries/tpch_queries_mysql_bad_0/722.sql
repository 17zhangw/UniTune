SELECT LINEITEM.L_LINESTATUS, PARTSUPP.PS_SUPPLYCOST, SUM(PARTSUPP.PS_SUPPLYCOST) FROM LINEITEM JOIN PARTSUPP ON PARTSUPP.PS_SUPPKEY=LINEITEM.L_SUPPKEY WHERE LINEITEM.L_DISCOUNT >= 0.03 GROUP BY LINEITEM.L_LINESTATUS, PARTSUPP.PS_SUPPLYCOST HAVING SUM(PARTSUPP.PS_SUPPLYCOST) <= 321.97 ORDER BY SUM(PARTSUPP.PS_SUPPLYCOST) ASC;
