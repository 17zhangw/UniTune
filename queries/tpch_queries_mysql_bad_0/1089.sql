SELECT CUSTOMER.C_NAME, NATION.N_NATIONKEY, MAX(NATION.N_NAME), MIN(NATION.N_NATIONKEY) FROM CUSTOMER JOIN NATION ON NATION.N_NATIONKEY=CUSTOMER.C_NATIONKEY GROUP BY CUSTOMER.C_NAME, NATION.N_NATIONKEY HAVING MIN(NATION.N_NATIONKEY) >= CUSTOMER.C_CUSTKEY ORDER BY CUSTOMER.C_NAME DESC, NATION.N_NATIONKEY DESC;
