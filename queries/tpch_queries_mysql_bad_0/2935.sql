SELECT PARTSUPP.PS_SUPPKEY, LINEITEM.L_SUPPKEY, ORDERS.O_SHIPPRIORITY, MAX(LINEITEM.L_TAX), AVG(PARTSUPP.PS_SUPPLYCOST) FROM ORDERS JOIN LINEITEM ON LINEITEM.L_ORDERKEY=ORDERS.O_ORDERKEY JOIN PARTSUPP ON PARTSUPP.PS_SUPPKEY=LINEITEM.L_SUPPKEY WHERE LINEITEM.L_SHIPINSTRUCT < 'COLLECT COD              ' GROUP BY PARTSUPP.PS_SUPPKEY, LINEITEM.L_SUPPKEY, ORDERS.O_SHIPPRIORITY;
