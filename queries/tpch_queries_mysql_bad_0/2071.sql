SELECT ORDERS.O_ORDERPRIORITY, MIN(ORDERS.O_ORDERSTATUS), COUNT(ORDERS.O_SHIPPRIORITY), AVG(ORDERS.O_SHIPPRIORITY), MIN(ORDERS.O_COMMENT) FROM ORDERS WHERE ORDERS.O_ORDERSTATUS >= 'P' GROUP BY ORDERS.O_ORDERPRIORITY HAVING MIN(ORDERS.O_ORDERSTATUS) <= 'O';
