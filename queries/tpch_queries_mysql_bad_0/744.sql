SELECT CUSTOMER.C_ADDRESS, ORDERS.O_ORDERKEY, MIN(ORDERS.O_ORDERSTATUS) FROM ORDERS JOIN CUSTOMER ON CUSTOMER.C_CUSTKEY=ORDERS.O_CUSTKEY GROUP BY CUSTOMER.C_ADDRESS, ORDERS.O_ORDERKEY HAVING MIN(ORDERS.O_ORDERSTATUS) >= 'P' ORDER BY CUSTOMER.C_ADDRESS ASC, ORDERS.O_ORDERKEY ASC;
