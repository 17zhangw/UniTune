SELECT ORDERS.O_CUSTKEY, CUSTOMER.C_MKTSEGMENT, LINEITEM.L_DISCOUNT, PARTSUPP.PS_PARTKEY, SUPPLIER.S_NAME, NATION.N_NAME, MIN(SUPPLIER.S_COMMENT), MAX(NATION.N_NAME), COUNT(CUSTOMER.C_NAME), MAX(PARTSUPP.PS_COMMENT), AVG(NATION.N_REGIONKEY) FROM ORDERS JOIN LINEITEM ON LINEITEM.L_ORDERKEY=ORDERS.O_ORDERKEY JOIN PARTSUPP ON PARTSUPP.PS_SUPPKEY=LINEITEM.L_SUPPKEY JOIN SUPPLIER ON SUPPLIER.S_SUPPKEY=PARTSUPP.PS_SUPPKEY JOIN NATION ON NATION.N_NATIONKEY=SUPPLIER.S_NATIONKEY JOIN CUSTOMER ON CUSTOMER.C_NATIONKEY=NATION.N_NATIONKEY GROUP BY ORDERS.O_CUSTKEY, CUSTOMER.C_MKTSEGMENT, LINEITEM.L_DISCOUNT, PARTSUPP.PS_PARTKEY, SUPPLIER.S_NAME, NATION.N_NAME ORDER BY MAX(PARTSUPP.PS_COMMENT) ASC, MIN(SUPPLIER.S_COMMENT) DESC, AVG(NATION.N_REGIONKEY) DESC, COUNT(CUSTOMER.C_NAME) ASC;
