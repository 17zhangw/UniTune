SELECT LINEITEM.L_SHIPDATE, NATION.N_REGIONKEY, ORDERS.O_TOTALPRICE, CUSTOMER.C_MKTSEGMENT FROM NATION JOIN CUSTOMER ON CUSTOMER.C_NATIONKEY=NATION.N_NATIONKEY JOIN ORDERS ON ORDERS.O_CUSTKEY=CUSTOMER.C_CUSTKEY JOIN LINEITEM ON LINEITEM.L_ORDERKEY=ORDERS.O_ORDERKEY WHERE LINEITEM.L_RECEIPTDATE <= '1998-03-04' ORDER BY LINEITEM.L_SHIPDATE ASC, CUSTOMER.C_MKTSEGMENT DESC, NATION.N_REGIONKEY DESC;
