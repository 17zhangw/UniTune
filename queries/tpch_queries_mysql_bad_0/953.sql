SELECT LINEITEM.L_SHIPMODE, ORDERS.O_ORDERPRIORITY, AVG(LINEITEM.L_PARTKEY), COUNT(LINEITEM.L_COMMITDATE) FROM ORDERS JOIN LINEITEM ON LINEITEM.L_ORDERKEY=ORDERS.O_ORDERKEY GROUP BY LINEITEM.L_SHIPMODE, ORDERS.O_ORDERPRIORITY ORDER BY COUNT(LINEITEM.L_COMMITDATE) DESC, AVG(LINEITEM.L_PARTKEY) DESC;
