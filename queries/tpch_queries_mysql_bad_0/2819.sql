SELECT PARTSUPP.PS_PARTKEY, LINEITEM.L_RETURNFLAG, MIN(LINEITEM.L_LINESTATUS) FROM LINEITEM, PARTSUPP GROUP BY PARTSUPP.PS_PARTKEY, LINEITEM.L_RETURNFLAG HAVING MIN(LINEITEM.L_LINESTATUS) != 'O' ORDER BY LINEITEM.L_RETURNFLAG DESC, PARTSUPP.PS_PARTKEY ASC;
