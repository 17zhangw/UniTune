SELECT ORDERS.O_ORDERKEY, LINEITEM.L_SHIPMODE, PARTSUPP.PS_SUPPLYCOST, SUM(LINEITEM.L_ORDERKEY) FROM PARTSUPP JOIN LINEITEM ON LINEITEM.L_SUPPKEY=PARTSUPP.PS_SUPPKEY JOIN ORDERS ON ORDERS.O_ORDERKEY=LINEITEM.L_ORDERKEY WHERE ORDERS.O_SHIPPRIORITY >= 0 GROUP BY ORDERS.O_ORDERKEY, LINEITEM.L_SHIPMODE, PARTSUPP.PS_SUPPLYCOST HAVING SUM(LINEITEM.L_ORDERKEY) <= 998 ORDER BY ORDERS.O_ORDERKEY DESC;
