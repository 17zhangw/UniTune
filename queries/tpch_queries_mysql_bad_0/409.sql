SELECT LINEITEM.L_PARTKEY, ORDERS.O_CLERK, CUSTOMER.C_ACCTBAL, MAX(CUSTOMER.C_MKTSEGMENT) FROM CUSTOMER JOIN ORDERS ON ORDERS.O_CUSTKEY=CUSTOMER.C_CUSTKEY JOIN LINEITEM ON LINEITEM.L_ORDERKEY=ORDERS.O_ORDERKEY WHERE ORDERS.O_CUSTKEY > 4816 GROUP BY LINEITEM.L_PARTKEY, ORDERS.O_CLERK, CUSTOMER.C_ACCTBAL HAVING MAX(CUSTOMER.C_MKTSEGMENT) >= 'MACHINERY ' ORDER BY MAX(CUSTOMER.C_MKTSEGMENT) ASC;
