SELECT PART.P_PARTKEY, LINEITEM.L_COMMENT, PARTSUPP.PS_AVAILQTY, SUM(PARTSUPP.PS_SUPPKEY), AVG(PART.P_SIZE), SUM(PARTSUPP.PS_AVAILQTY), SUM(LINEITEM.L_PARTKEY), COUNT(PARTSUPP.PS_AVAILQTY), COUNT(PART.P_NAME) FROM LINEITEM JOIN PARTSUPP ON PARTSUPP.PS_SUPPKEY=LINEITEM.L_SUPPKEY JOIN PART ON PART.P_PARTKEY=PARTSUPP.PS_PARTKEY GROUP BY PART.P_PARTKEY, LINEITEM.L_COMMENT, PARTSUPP.PS_AVAILQTY ORDER BY PARTSUPP.PS_AVAILQTY DESC, LINEITEM.L_COMMENT ASC, PART.P_PARTKEY DESC;
